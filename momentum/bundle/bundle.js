(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){let t=(new Date).toLocaleDateString(e,{weekday:"long",month:"long",day:"numeric"});t=t.split(" ").map((e=>e[0].toUpperCase()+e.slice(1))).join(" "),document.querySelector(".date").innerHTML=t}function n(){const e=new Date;document.querySelector(".time").innerHTML=e.toLocaleTimeString("ru")}e.d({},{q:()=>Ve});const o=document.querySelector(".settings-btn"),a=document.querySelector(".settings-wrapper"),l=document.querySelectorAll(".settings-panels-list input");document.querySelectorAll(".settings-widget"),document.body.addEventListener("click",(e=>{e.target.closest(".settings-wrapper")||e.target.closest(".modal-panel")||e.target.closest(".modal-message")||e.target.closest(".modal")||e.target.closest(".modal-close")||a.classList.remove("active")}));const r=function(){const e=(new Date).getHours();return Math.floor(e/6)}(),c=["night","morning","afternoon","evening"];let s={language:localStorage.getItem("language")?localStorage.getItem("language"):"en",photoSource:localStorage.getItem("photoSource")?localStorage.getItem("photoSource"):"github",tags:c[r],tagsApiContainer:localStorage.getItem("tagsApiContainer")?localStorage.getItem("tagsApiContainer"):"none",tagsApi:localStorage.getItem("tagsApi")?localStorage.getItem("tagsApi"):c[r],panels:JSON.parse(localStorage.getItem("panels"))?JSON.parse(localStorage.getItem("panels")):[{widget:"time",shown:!0,en:"Time",ru:"Время"},{widget:"date",shown:!0,en:"Date",ru:"Дата"},{widget:"greeting",shown:!0,en:"Greeting",ru:"Приветствие"},{widget:"quote",shown:!0,en:"Quote",ru:"Цитаты"},{widget:"weather",shown:!0,en:"Weather",ru:"Погода"},{widget:"player",shown:!0,en:"Player",ru:"Плеер"},{widget:"todo",shown:!0,en:"Todo",ru:"Список дел"}]};function i(e){l.forEach((t=>{const n=s.panels.find((e=>e.widget===t.value));t.closest("label").firstElementChild.innerHTML="en"===e?n.en:n.ru}))}function d(e){document.querySelector(`.${e.target.value}-panel`).classList.toggle("panel-hidden"),e.target.checked?s.panels.find((t=>t.widget===e.target.value)).shown=!0:s.panels.find((t=>t.widget===e.target.value)).shown=!1}function u(e){document.querySelector(".settings-language h4").innerHTML="ru"===e?"Язык":"Language",document.querySelector(".settings-img h4").innerHTML="ru"===e?"Фотографии":"Photos",document.querySelector(".settings-panels h4").innerHTML="ru"===e?"Основные":"General"}l.forEach((e=>{const t=s.panels.find((t=>t.widget===e.value));t.shown&&(e.checked=t.shown)})),l.forEach((e=>{e.checked?(document.querySelector(`.${e.value}-panel`).classList.remove("panel-hidden"),s.panels.find((t=>t.widget===e.value)).shown=!0):(document.querySelector(`.${e.value}-panel`).classList.add("panel-hidden"),s.panels.find((t=>t.widget===e.value)).shown=!1)})),l.forEach((e=>{e.addEventListener("change",d)}));const g=[{night:{ru:"Доброй/Спокойной ночи",en:"Good night"}},{morning:{ru:"Доброе утро",en:"Good morning"}},{afternoon:{ru:"Добрый день",en:"Good afternoon"}},{evening:{ru:"Добрый вечер",en:"Good evening"}}],m=document.querySelector(".name");function p(e){let t=Object.values(g[r])[0];document.querySelector(".greeting").innerHTML=t[e]}function h(e){m.placeholder="ru"===e?"[Введите ваше имя]":"[Enter your name]"}let v=String((1,21,Math.floor(20*Math.random())+1));const f=s.tags;let S,y,L=s.tagsApi;const w=document.querySelector(".tag-img"),E=document.querySelector(".tag-container"),I=document.querySelector(".tag-error");function q(e){I.style.display=e,document.querySelectorAll(".tag-container span:not(:first-child)").forEach((t=>{localStorage.setItem("tagsApiContainer",e),s.tagsApiContainer=e,t.style.display=s.tagsApiContainer}))}function b(){return"github"===s.photoSource?(y=function(){const e=`https://raw.githubusercontent.com/irvelds/stage1-tasks/assets/images/${f}/${v.padStart(2,"0")}.jpg`;return S=e,e}(),w.disabled=!w.disabled,q("none")):"unsplash"===s.photoSource?(y=async function(){const e=`https://api.unsplash.com/photos/random?lang=en&orientation=landscape&query=${L}&client_id=ZtvWCVVtYpqIknQlYxjgcsgBx4sy-IEZV2M8RtD3tUs`;try{const t=await fetch(e),n=await t.json();S=n.urls.regular,k()}catch(e){document.querySelector("body").removeAttribute("style"),Ve(!0,("ru"===s.language?"Unsplash API: Ваш лимит 50 фотографий в час исчерпан. Попробуйте позже.":"Unsplash API: Your limit of 50 photos per hour has been reached. Try later.")+" "),S=""}}(),w.disabled=!1,q("flex")):"flickr"===s.photoSource&&(y=async function(){const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=433d357743e76a7ff1fdd1796c3e244f&tags=${L}&extras=url_l&format=json&nojsoncallback=1`;try{const t=await fetch(e),n=await t.json(),o=Math.round(Math.random()*n.photos.photo.length);S=n.photos.photo[o].url_l,k()}catch(e){document.querySelector("body").removeAttribute("style"),Ve(!0,("ru"===s.language?"Flickr API. Ошибка сервера. Попробуйте позже.":"Unsplash API: Server error. Try later.")+" "),S=""}}(),w.disabled=!1,q("flex")),y}function k(){const e=new Image;e.src=S,e.addEventListener("load",(()=>{document.querySelector("body").style.backgroundImage=`url('${S}')`}))}function $(){document.querySelectorAll(".close-tag").forEach((e=>{e.addEventListener("click",(e=>{e.target.parentNode.remove();const t=e.target.closest("span").textContent.slice(0,-1),n=localStorage.getItem("tagsApi").split(",").filter((e=>e!==t));localStorage.setItem("tagsApi",n),L=n.join(","),e.stopPropagation()}))}))}function A(e){I.textContent="ru"===e?"Тег должен содержать только латинские буквы и не более 15 символов":"The tag must contain only latin letters and no more than 15 characters"}b(),document.querySelector(".slide-next").addEventListener("click",(function(){v<20?v++:v=1,v=String(v),b(),k()})),document.querySelector(".slide-prev").addEventListener("click",(function(){v>1?v--:v=20,v=String(v),b(),k()})),window.addEventListener("load",(function(){w.addEventListener("change",(e=>{if(t=e.target,/^[a-zA-Z-]{0,20}$/g.test(t.value)&&e.target.value.length<20){let t=[];t.push(e.target.value.trim()),L=[L,...t].join(","),localStorage.setItem("tagsApi",L);let n=document.createElement("span");n.innerHTML=`${e.target.value}<button class="close-tag">x</button>`,E.appendChild(n),e.target.value="",I.textContent="",$()}else A(s.language);var t}))})),window.addEventListener("load",(function(){localStorage.getItem("tagsApi")&&(L=[localStorage.getItem("tagsApi")].join(",")),new Set(L.split(",")).forEach((e=>{let t=document.createElement("span");t.innerHTML=`${e}<button class="close-tag">x</button>`,E.appendChild(t)})),q(s.tagsApiContainer)})),window.addEventListener("load",$);let x="",T=0,C="",M="";const N=document.querySelector(".quote"),O=document.querySelector(".author"),H=async function(){const e=await fetch("src/data.json");let t=await e.json();return x=Math.floor(Math.random()*t[0].length),T=t[0].length,t}().then((e=>e));function J(e,t){"ru"===e&&(C=t[0][x].textRu,M=t[0][x].authorRu),"en"===e&&(C=t[0][x].textEn,M=t[0][x].authorEn),N.classList.add("active"),N.innerHTML=`"${C}"`,O.classList.add("active"),O.innerHTML=M}function j(e){H.then((t=>{J(e,t)}))}const D=document.querySelector(".weather-icon"),P=document.querySelector(".temperature"),R=document.querySelector(".weather-info"),G=document.querySelector(".weather-description"),W=document.querySelector(".city"),U=document.querySelector(".humidity"),Y=document.querySelector(".wind"),F=document.querySelector(".weather-error");let _="",B="",V="";async function Z(e){const t=`https://api.openweathermap.org/data/2.5/weather?q=${W.value}&lang=${e}&appid=40e213fbac776cc0243fd83571be2c75&units=metric`,n=await fetch(t),o=await n.json();200===o.cod?(R.classList.add("active"),D.className="weather-icon owf",D.classList.add(`owf-${o.weather[0].id}`),P.textContent=`${Math.round(o.main.temp)}°C`,G.textContent=o.weather[0].description,U.textContent=`${_}: ${Math.round(o.main.humidity)} %`,Y.textContent=`${B}: ${o.wind.speed.toFixed(0)} ${V}`,Q(o,e)):(R.classList.remove("active"),Q(o,e),D.className="weather-icon none owf",P.textContent="",G.textContent="",U.textContent="",Y.textContent="")}function Q(e,t){"city not found"===e.message||"Nothing to geocode"===e.message?(F.classList.add("active"),F.textContent="ru"===t?"Город не найден.":"City is not found. Please check spelling"):(F.classList.remove("active"),F.textContent="")}function X(e){"Минск"!==W.value&&"Minsk"!==W.value||(W.value="ru"===e?"Минск":"Minsk"),Z(s.language),_="ru"===e?"Относительная влажность":"Humidity",B="ru"===e?"Cкорость ветра":"Wind speed",V="ru"===e?"м/с":"m/s",W.placeholder="ru"===e?"[Введите город]":"[Enter the city]"}W.addEventListener("change",(function(e){localStorage.setItem("city",W.value),Z(s.language)})),W.addEventListener("keypress",(e=>{13===e.which&&W.blur()})),window.addEventListener("beforeunload",(()=>{W.blur()})),localStorage.getItem("city")&&(W.value=localStorage.getItem("city"));const z=[{title:"Aqua Caelestis",src:"assets/sounds/AquaCaelestis.mp3",duration:"00:39"},{title:"Ennio Morricone",src:"assets/sounds/EnnioMorricone.mp3",duration:"01:37"},{title:"River Flows In You",src:"assets/sounds/RiverFlowsInYou.mp3",duration:"01:37"},{title:"Summer Wind",src:"assets/sounds/SummerWind.mp3",duration:"01:50"},{title:"Coda",src:"assets/sounds/Coda.mp3",duration:"02:43"}],K=document.querySelector(".play"),ee=document.querySelector(".play-next"),te=document.querySelector(".play-prev"),ne=document.querySelector(".play-list-container"),oe=document.querySelector(".play-track-name"),ae=document.querySelector(".player-range");let le=!1,re=0;const ce=new Audio,se="#E1EA35";for(let e=0;e<z.length;e++){const t=document.createElement("li");t.classList.add("play-item"),t.textContent=z[e].title,ne.append(t)}const ie=document.querySelectorAll(".play-item");function de(){le?(K.classList.add("pause"),ie.forEach((e=>e.classList.remove("playing"))),ie[re].classList.add("playing")):(K.classList.remove("pause"),ie.forEach((e=>e.classList.remove("playing"))))}function ue(){ce.src=z[re].src,ce.play(),ce.currentTime=0,le=!0,document.querySelectorAll(".play-item").forEach(((e,t)=>{t===re?(oe.innerHTML=`${re+1}. ${z[re].title}`,e.classList.add("item-active")):e.classList.remove("item-active")})),de()}function ge(){le?(ce.pause(),le=!1,de()):le||ue()}function me(){re<z.length-1?re++:re=0,ue()}function pe(e){const t=new Date(1e3*e).toISOString().substr(11,8);return{minutes:t.substr(3,2),seconds:t.substr(6,2)}}ie.forEach(((e,t)=>e.addEventListener("click",(()=>{var e;(e=t)===re?ge():(re=e,ue())})))),oe.innerHTML="1."+z[0].title,ie[0].classList.add("item-active"),ce.addEventListener("loadedmetadata",(function(){const e=pe(Math.round(ce.duration));ae.setAttribute("max",Math.round(ce.duration)),document.querySelector(".play-track-duration").innerHTML=`${e.minutes}:${e.seconds}`,document.querySelector(".play-track-duration").setAttribute("datetime",`${e.minutes}m ${e.seconds}s`)})),ce.addEventListener("timeupdate",(function(){const e=pe(Math.round(ce.currentTime));document.querySelector(".play-track-current-time").innerHTML=`${e.minutes}:${e.seconds}`,document.querySelector(".play-track-current-time").setAttribute("datetime",`${e.minutes}m ${e.seconds}s`)})),ce.addEventListener("timeupdate",(function(){ae.value=Math.floor(ce.currentTime);let e=Math.floor(ce.currentTime/ce.duration*100);ae.style.background=`linear-gradient(to right, ${se}, 0%,  ${se}, ${e}%, #ffffff ${e}%)`}));const he=document.getElementById("player-tooltip");ae.addEventListener("mousemove",(function(e){const t=Math.round(e.offsetX/e.target.clientWidth*parseInt(e.target.getAttribute("max"),10));ae.setAttribute("data-seek",t);const n=pe(t);he.textContent=`${n.minutes}:${n.seconds}`;const o=ce.getBoundingClientRect();he.style.left=e.pageX-o.left+"px"})),ae.addEventListener("input",(function(e){const t=e.target.dataset.playerRange?e.target.dataset.playerRange:e.target.value;ce.currentTime=t,ae.value=t}));const ve=document.querySelector(".volume-button"),fe=document.querySelectorAll(".volume-button use"),Se=document.querySelector('use[href="#volume-mute"]'),ye=document.querySelector('use[href="#volume-low"]'),Le=document.querySelector('use[href="#volume-high"]'),we=document.querySelector(".volume-range");we.style.background=`linear-gradient(to right, ${se}, 0%,  ${se}, ${100*we.value}%, #ffffff ${100*we.value}%)`,we.addEventListener("input",(function(){ce.muted&&(ce.muted=!1),ce.volume=we.value,we.style.background=`linear-gradient(to right, ${se}, 0%,  ${se}, ${100*we.value}%, #ffffff ${100*we.value}%)`})),ve.addEventListener("click",(function(){ce.muted=!ce.muted,ce.muted?(we.setAttribute("data-volume",we.value),we.value=0,we.style.background=`linear-gradient(to right, ${se}, 0%,  ${se}, 0%, #ffffff 0%)`):(we.value=we.dataset.volume,we.style.background=`linear-gradient(to right, ${se}, 0%,  ${se}, ${100*we.value}%, #ffffff ${100*we.value}%)`)})),ce.addEventListener("volumechange",(function(){fe.forEach((e=>{e.classList.add("hidden")})),ce.muted||0===ce.volume?Se.classList.remove("hidden"):ce.volume>0&&ce.volume<=.5?ye.classList.remove("hidden"):Le.classList.remove("hidden"),ce.muted&&0===ce.volume&&"0"===we.dataset.volume&&(fe.forEach((e=>{e.classList.add("hidden")})),ye.classList.remove("hidden")),console.log(ce.muted)})),ce.addEventListener("ended",me),te.addEventListener("click",(function(){re>0?re--:re=z.length-1,ue()})),ee.addEventListener("click",me),K.addEventListener("click",ge);const Ee=document.querySelector(".todo-btn"),Ie=document.querySelector(".todo-widget-container"),qe=document.querySelector(".todo-input"),be=document.querySelector(".todo-add-new-btn"),ke=document.querySelector(".todo-list"),$e=document.querySelector(".todo-description");Ee.addEventListener("click",(()=>{Ie.classList.contains("active")?Ie.classList.remove("active"):(Ie.classList.add("active"),Ne())}));let Ae=localStorage.getItem("todoId")?+localStorage.getItem("todoId"):0,xe=JSON.parse(localStorage.getItem("todo"))?JSON.parse(localStorage.getItem("todo")):[],Te=JSON.parse(localStorage.getItem("todoDone"))?JSON.parse(localStorage.getItem("todoDone")):[],Ce=JSON.parse(localStorage.getItem("todoNone"))?JSON.parse(localStorage.getItem("todoNone")):[],Me=localStorage.getItem("selectTodoItem1")?localStorage.getItem("selectTodoItem1"):"all";function Ne(){0===xe.length?($e.style.display="block",be.style.display="inline-block",qe.style.display="none"):($e.style.display="none",qe.style.display="block")}be.addEventListener("click",(e=>{qe.style.display="block",e.target.style.display="none"}));class Oe{constructor(e,t,n){this.id=e,this.title=t,this.completed=n}}const He=document.querySelector("#list2");let Je=[{value:"all",text:"All",length:xe.length,checked:!0},{value:"done",text:"Done",length:Ce.length,checked:!1},{value:"none",text:"Not yet",length:Te.length,checked:!1}];function je(e){ke.innerHTML="",e.length>0&&e.forEach((e=>{(e=>{const t=document.createElement("li");t.classList.add("todo-items");const n=document.createElement("input");n.type="checkbox",n.id=e.id,n.classList.add("todo-check"),n.checked=e.completed,t.append(n),n.addEventListener("change",Fe);const o=document.createElement("span");o.classList.add("checkmark"),t.append(o);const a=document.createElement("div");a.id=`b${e.id}`,a.contentEditable="false",a.innerText=e.title,a.classList.add("todo-val-input"),a.addEventListener("input",Ue),a.addEventListener("keypress",(e=>{13===e.which&&(a.contentEditable="false")}));const l=document.createElement("label");l.classList.add("todo-label"),l.appendChild(a),t.append(l);const r=document.createElement("button");r.id=`c${e.id}`,r.classList.add("todo-button","todo-del"),t.append(r),r.addEventListener("click",_e);const c=document.createElement("button");c.id=`d${e.id}`,c.classList.add("todo-button","todo-edit"),t.append(c),c.addEventListener("click",Ye),ke.prepend(t)})(e)}))}Je.forEach((e=>{!function(e){const t=document.createElement("input");t.classList.add("selectopt"),t.type="radio",t.name="todo-item",t.value=e.value,t.id=e.value,t.setAttribute("checked",e.check),He.append(t);const n=document.createElement("label");n.classList="select-option",n.setAttribute("for",e.value),n.id=`lab-${e.value}`,n.innerText=e.text;const o=document.createElement("span");o.classList.add("count"),o.innerText=e.length,n.appendChild(o),He.append(n)}(e)}));const De=document.querySelector("form");function Pe(){"all"==Me?je(xe):"done"==Me?je(Te):"none"==Me&&je(Ce)}function Re(){Te=xe.filter((e=>1==e.completed))}function Ge(){Ce=xe.filter((e=>0==e.completed))}function We(){Je[0].length=xe.length,document.querySelector("#lab-all span").innerText=Je[0].length,Je[1].length=Te.length,document.querySelector("#lab-done span").innerText=Je[1].length,Je[2].length=Ce.length,document.querySelector("#lab-none span").innerText=Je[2].length}function Ue(){xe.find((e=>e.id==this.id.slice(1))).title=this.innerText.trim(),Re(),Ge(),Be()}function Ye(){const e=document.querySelectorAll(".todo-val-input");let t=Array.from(e).find((e=>e.id.slice(1)==this.id.slice(1)));t.contentEditable="true",t.focus()}function Fe(){let e=xe.find((e=>e.id==this.id));e.completed=!e.completed,Re(),Ge(),We(),Be(),Pe()}function _e(){xe=xe.filter((e=>e.id!=this.id.slice(1))),Re(),Ge(),We(),Be(),Pe(),Ne()}function Be(){localStorage.setItem("todo",JSON.stringify(xe)),localStorage.setItem("todoDone",JSON.stringify(Te)),localStorage.setItem("todoNone",JSON.stringify(Ce))}function Ve(e,t){const n=document.querySelector(".modal-panel"),o=document.querySelector(".modal"),a=document.querySelector(".modal-message");e?(n.classList.add("active"),o.classList.add("active"),a.textContent=t,document.querySelector(".modal-close").addEventListener("click",(e=>{n.classList.remove("active"),o.classList.remove("active")})),n.addEventListener("click",(e=>{e.target.classList.contains("modal")||e.target.classList.contains("modal-message")||(n.classList.remove("active"),o.classList.remove("active"))}))):(n.classList.remove("active"),o.classList.remove("active"))}De.addEventListener("submit",(e=>{e.preventDefault()})),De.elements["todo-item"].value=Me,De.addEventListener("change",(e=>(Me=e.target.value,"all"===e.target.value?(localStorage.setItem("selectTodoItem1","all"),je(xe)):"done"===e.target.value?(localStorage.setItem("selectTodoItem1","done"),je(Te)):"none"===e.target.value&&(localStorage.setItem("selectTodoItem1","none"),je(Ce)),Me))),Pe(),Re(),Ge(),We(),qe.addEventListener("keypress",(e=>{if(13===e.which&&""!==qe.value){Ae+=1,localStorage.setItem("todoId",Ae);let e=!1;e="done"==Me,xe.push(new Oe(Ae,qe.value,e)),Re(),Ge(),We(),Be(),Pe(),Ne(),qe.value=""}})),window.addEventListener("beforeunload",Be),window.addEventListener("load",(function(){localStorage.getItem("todo")&&(xe=JSON.parse(localStorage.getItem("todo"))),localStorage.getItem("todoDone")&&(Te=JSON.parse(localStorage.getItem("todoDone"))),localStorage.getItem("todoNone")&&(Ce=JSON.parse(localStorage.getItem("todoNone"))),localStorage.getItem("selectTodoItem1")&&(Me=JSON.parse(localStorage.getItem("selectTodoItem1")))})),document.querySelectorAll('[name="radio-lng"]').forEach((e=>{e.addEventListener("change",(e=>{s.language=e.target.value,t(s.language),p(s.language),h(s.language),j(s.language),X(s.language),u(s.language),i(s.language),""!==I.textContent&&A(s.language)})),e.value===localStorage.getItem("language")&&(e.checked=!0)})),document.querySelectorAll('[name="widget-img"]').forEach((e=>{e.addEventListener("change",(e=>{s.photoSource=e.target.value,b(),k()})),e.value===localStorage.getItem("photoSource")&&(e.checked=!0)})),t(s.language),n(),setInterval((function(){n()}),1e3),p(s.language),window.addEventListener("beforeunload",(function(){localStorage.setItem("name",m.value)})),window.addEventListener("load",(function(){localStorage.getItem("name")&&(m.value=localStorage.getItem("name"))})),h(s.language),k(),j(s.language),document.querySelector(".change-quote").addEventListener("click",(e=>{var t;e.target.classList.toggle("active"),t=s.language,x++,x===T&&(x=0),H.then((e=>{N.classList.remove("active"),O.classList.remove("active"),setTimeout((()=>{J(t,e)}),500)}))})),X(s.language),o.addEventListener("click",(e=>{e.target.classList.toggle("active"),a.classList.contains("active")?a.classList.remove("active"):a.classList.add("active")})),u(s.language),window.addEventListener("beforeunload",(function(){localStorage.setItem("language",s.language),localStorage.setItem("photoSource",s.photoSource),localStorage.setItem("panels",JSON.stringify(s.panels))})),window.addEventListener("load",(function(){localStorage.getItem("language")&&(s.language=localStorage.getItem("language")),localStorage.getItem("photoSource")&&(s.photoSource=localStorage.getItem("photoSource")),localStorage.getItem("panels")&&(s.panels=JSON.parse(localStorage.getItem("panels")))})),i(s.language),window.addEventListener("load",(function(){this.document.body.classList.remove("preload")}))})();