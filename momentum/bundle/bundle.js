(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){let t=(new Date).toLocaleDateString(e,{weekday:"long",month:"long",day:"numeric"});t=t.split(" ").map((e=>e[0].toUpperCase()+e.slice(1))).join(" "),document.querySelector(".date").innerHTML=t}function n(){const e=new Date;document.querySelector(".time").innerHTML=e.toLocaleTimeString("ru")}e.d({},{q:()=>Be});const o=document.querySelector(".settings-btn"),a=document.querySelector(".settings-wrapper"),l=document.querySelectorAll(".settings-panels-list input");document.querySelectorAll(".settings-widget"),document.body.addEventListener("click",(e=>{e.target.closest(".settings-wrapper")||e.target.closest(".modal-panel")||e.target.closest(".modal-message")||e.target.closest(".modal")||e.target.closest(".modal-close")||a.classList.remove("active")}));const c=function(){const e=(new Date).getHours();return Math.floor(e/6)}(),r=["night","morning","afternoon","evening"];let s={language:localStorage.getItem("language")?localStorage.getItem("language"):"en",photoSource:localStorage.getItem("photoSource")?localStorage.getItem("photoSource"):"github",tags:r[c],tagsApiContainer:localStorage.getItem("tagsApiContainer")?localStorage.getItem("tagsApiContainer"):"none",tagsApi:localStorage.getItem("tagsApi")?localStorage.getItem("tagsApi"):r[c],panels:JSON.parse(localStorage.getItem("panels"))?JSON.parse(localStorage.getItem("panels")):[{widget:"time",shown:!0,en:"Time",ru:"Время"},{widget:"date",shown:!0,en:"Date",ru:"Дата"},{widget:"greeting",shown:!0,en:"Greeting",ru:"Приветствие"},{widget:"quote",shown:!0,en:"Quote",ru:"Цитаты"},{widget:"weather",shown:!0,en:"Weather",ru:"Погода"},{widget:"player",shown:!0,en:"Player",ru:"Плеер"},{widget:"todo",shown:!0,en:"Todo",ru:"Список дел"}]};function i(e){l.forEach((t=>{const n=s.panels.find((e=>e.widget===t.value));t.closest("label").firstElementChild.innerHTML="en"===e?n.en:n.ru}))}function d(e){document.querySelector(`.${e.target.value}-panel`).classList.toggle("panel-hidden"),e.target.checked?s.panels.find((t=>t.widget===e.target.value)).shown=!0:s.panels.find((t=>t.widget===e.target.value)).shown=!1}function u(e){document.querySelector(".settings-language h4").innerHTML="ru"===e?"Язык":"Language",document.querySelector(".settings-img h4").innerHTML="ru"===e?"Фотографии":"Photos",document.querySelector(".settings-panels h4").innerHTML="ru"===e?"Основные":"General"}l.forEach((e=>{const t=s.panels.find((t=>t.widget===e.value));t.shown&&(e.checked=t.shown)})),l.forEach((e=>{e.checked?(document.querySelector(`.${e.value}-panel`).classList.remove("panel-hidden"),s.panels.find((t=>t.widget===e.value)).shown=!0):(document.querySelector(`.${e.value}-panel`).classList.add("panel-hidden"),s.panels.find((t=>t.widget===e.value)).shown=!1)})),l.forEach((e=>{e.addEventListener("change",d)}));const g=[{night:{ru:"Доброй/Спокойной ночи",en:"Good night"}},{morning:{ru:"Доброе утро",en:"Good morning"}},{afternoon:{ru:"Добрый день",en:"Good afternoon"}},{evening:{ru:"Добрый вечер",en:"Good evening"}}],m=document.querySelector(".name");function p(e){let t=Object.values(g[c])[0];document.querySelector(".greeting").innerHTML=t[e]}function h(e){m.placeholder="ru"===e?"[Введите ваше имя]":"[Enter your name]"}let f=String((1,21,Math.floor(20*Math.random())+1));const v=s.tags;let S,y,L=s.tagsApi;const w=document.querySelector(".tag-img"),E=document.querySelector(".tag-container"),I=document.querySelector(".tag-error");function q(e){I.style.display=e,document.querySelectorAll(".tag-container span:not(:first-child)").forEach((t=>{localStorage.setItem("tagsApiContainer",e),s.tagsApiContainer=e,t.style.display=s.tagsApiContainer}))}function b(){return"github"===s.photoSource?(y=function(){const e=`https://raw.githubusercontent.com/irvelds/stage1-tasks/assets/images/${v}/${f.padStart(2,"0")}.jpg`;return S=e,e}(),w.disabled=!w.disabled,q("none")):"unsplash"===s.photoSource?(y=async function(){const e=`https://api.unsplash.com/photos/random?lang=en&orientation=landscape&query=${L}&client_id=ZtvWCVVtYpqIknQlYxjgcsgBx4sy-IEZV2M8RtD3tUs`;try{const t=await fetch(e),n=await t.json();S=n.urls.regular,k()}catch(e){document.querySelector("body").removeAttribute("style"),Be(!0,("ru"===s.language?"Unsplash API: Ваш лимит 50 фотографий в час исчерпан. Попробуйте позже.":"Unsplash API: Your limit of 50 photos per hour has been reached. Try later.")+" "),S=""}}(),w.disabled=!1,q("flex")):"flickr"===s.photoSource&&(y=async function(){const e=`https://www.flickr.com/services/rest/?method=flickr.photos.search&api_key=433d357743e76a7ff1fdd1796c3e244f&tags=${L}&extras=url_l&format=json&nojsoncallback=1`;try{const t=await fetch(e),n=await t.json(),o=Math.round(Math.random()*n.photos.photo.length);S=n.photos.photo[o].url_l,k()}catch(e){document.querySelector("body").removeAttribute("style"),Be(!0,("ru"===s.language?"Flickr API. Ошибка сервера. Попробуйте позже.":"Unsplash API: Server error. Try later.")+" "),S=""}}(),w.disabled=!1,q("flex")),y}function k(){const e=new Image;e.src=S,e.addEventListener("load",(()=>{document.querySelector("body").style.backgroundImage=`url('${S}')`}))}function A(){document.querySelectorAll(".close-tag").forEach((e=>{e.addEventListener("click",(e=>{e.target.parentNode.remove();const t=e.target.closest("span").textContent.slice(0,-1),n=localStorage.getItem("tagsApi").split(",").filter((e=>e!==t));localStorage.setItem("tagsApi",n),L=n.join(","),e.stopPropagation()}))}))}function $(e){I.textContent="ru"===e?"Тег должен содержать только латинские буквы и не более 15 символов":"The tag must contain only latin letters and no more than 15 characters"}b(),document.querySelector(".slide-next").addEventListener("click",(function(){f<20?f++:f=1,f=String(f),b(),k()})),document.querySelector(".slide-prev").addEventListener("click",(function(){f>1?f--:f=20,f=String(f),b(),k()})),window.addEventListener("load",(function(){w.addEventListener("change",(e=>{if(t=e.target,/^[a-zA-Z-]{0,20}$/g.test(t.value)&&e.target.value.length<20){let t=[];t.push(e.target.value.trim()),L=[L,...t].join(","),localStorage.setItem("tagsApi",L);let n=document.createElement("span");n.innerHTML=`${e.target.value}<button class="close-tag">x</button>`,E.appendChild(n),e.target.value="",I.textContent="",A()}else $(s.language);var t}))})),window.addEventListener("load",(function(){localStorage.getItem("tagsApi")&&(L=[localStorage.getItem("tagsApi")].join(",")),new Set(L.split(",")).forEach((e=>{let t=document.createElement("span");t.innerHTML=`${e}<button class="close-tag">x</button>`,E.appendChild(t)})),q(s.tagsApiContainer)})),window.addEventListener("load",A);let x="",T=0,C="",M="";const N=document.querySelector(".quote"),O=document.querySelector(".author"),H=async function(){const e=await fetch("src/data.json");let t=await e.json();return x=Math.floor(Math.random()*t[0].length),T=t[0].length,t}().then((e=>e));function J(e,t){"ru"===e&&(C=t[0][x].textRu,M=t[0][x].authorRu),"en"===e&&(C=t[0][x].textEn,M=t[0][x].authorEn),N.classList.add("active"),N.innerHTML=`"${C}"`,O.classList.add("active"),O.innerHTML=M}function j(e){H.then((t=>{J(e,t)}))}const D=document.querySelector(".weather-icon"),P=document.querySelector(".temperature"),R=document.querySelector(".weather-info"),G=document.querySelector(".weather-description"),W=document.querySelector(".city"),U=document.querySelector(".humidity"),Y=document.querySelector(".wind"),F=document.querySelector(".weather-error");let _="",B="",V="";async function Z(e){const t=`https://api.openweathermap.org/data/2.5/weather?q=${W.value}&lang=${e}&appid=40e213fbac776cc0243fd83571be2c75&units=metric`,n=await fetch(t),o=await n.json();200===o.cod?(R.classList.add("active"),D.className="weather-icon owf",D.classList.add(`owf-${o.weather[0].id}`),P.textContent=`${o.main.temp}°C`,G.textContent=o.weather[0].description,U.textContent=`${_}: ${o.main.humidity} %`,Y.textContent=`${B}: ${o.wind.speed.toFixed(0)} ${V}`,Q(o,e)):(R.classList.remove("active"),Q(o,e),D.className="weather-icon none owf",P.textContent="",G.textContent="",U.textContent="",Y.textContent="")}function Q(e,t){"city not found"===e.message||"Nothing to geocode"===e.message?(F.classList.add("active"),F.textContent="ru"===t?"Город не найден.":"City is not found. Please check spelling"):(F.classList.remove("active"),F.textContent="")}function X(e){"Минск"!==W.value&&"Minsk"!==W.value||(W.value="ru"===e?"Минск":"Minsk"),Z(s.language),_="ru"===e?"Относительная влажность":"Humidity",B="ru"===e?"Cкорость ветра":"Wind speed",V="ru"===e?"м/с":"m/s",W.placeholder="ru"===e?"[Введите город]":"[Enter the city]"}W.addEventListener("change",(function(e){localStorage.setItem("city",W.value),Z(s.language)})),W.addEventListener("keypress",(e=>{13===e.which&&W.blur()})),window.addEventListener("beforeunload",(()=>{W.blur()})),localStorage.getItem("city")&&(W.value=localStorage.getItem("city"));const z=[{title:"Aqua Caelestis",src:"assets/sounds/AquaCaelestis.mp3",duration:"00:39"},{title:"Ennio Morricone",src:"assets/sounds/EnnioMorricone.mp3",duration:"01:37"},{title:"River Flows In You",src:"assets/sounds/RiverFlowsInYou.mp3",duration:"01:37"},{title:"Summer Wind",src:"assets/sounds/SummerWind.mp3",duration:"01:50"},{title:"Coda",src:"assets/sounds/Coda.mp3",duration:"02:43"}],K=document.querySelector(".play"),ee=document.querySelector(".play-next"),te=document.querySelector(".play-prev"),ne=document.querySelector(".play-list-container"),oe=document.querySelector(".play-track-name"),ae=document.querySelector(".player-range");let le=!1,ce=0;const re=new Audio;for(let e=0;e<z.length;e++){const t=document.createElement("li");t.classList.add("play-item"),t.textContent=z[e].title,ne.append(t)}const se=document.querySelectorAll(".play-item");function ie(){le?(K.classList.add("pause"),se.forEach((e=>e.classList.remove("playing"))),se[ce].classList.add("playing")):(K.classList.remove("pause"),se.forEach((e=>e.classList.remove("playing"))))}function de(){re.src=z[ce].src,re.play(),re.currentTime=0,le=!0,document.querySelectorAll(".play-item").forEach(((e,t)=>{t===ce?(oe.innerHTML=`${ce+1}. ${z[ce].title}`,e.classList.add("item-active")):e.classList.remove("item-active")})),ie()}function ue(){le?(re.pause(),le=!1,ie()):le||de()}function ge(){ce<z.length-1?ce++:ce=0,de()}function me(e){const t=new Date(1e3*e).toISOString().substr(11,8);return{minutes:t.substr(3,2),seconds:t.substr(6,2)}}se.forEach(((e,t)=>e.addEventListener("click",(()=>{var e;(e=t)===ce?ue():(ce=e,de())})))),oe.innerHTML="1."+z[0].title,se[0].classList.add("item-active"),re.addEventListener("loadedmetadata",(function(){const e=me(Math.round(re.duration));ae.setAttribute("max",Math.round(re.duration)),document.querySelector(".play-track-duration").innerHTML=`${e.minutes}:${e.seconds}`,document.querySelector(".play-track-duration").setAttribute("datetime",`${e.minutes}m ${e.seconds}s`)})),re.addEventListener("timeupdate",(function(){const e=me(Math.round(re.currentTime));document.querySelector(".play-track-current-time").innerHTML=`${e.minutes}:${e.seconds}`,document.querySelector(".play-track-current-time").setAttribute("datetime",`${e.minutes}m ${e.seconds}s`)})),re.addEventListener("timeupdate",(function(){ae.value=Math.floor(re.currentTime);let e=Math.floor(re.currentTime/re.duration*100);ae.style.background=`linear-gradient(to right, #c1ff06, 0%,  #c1ff06, ${e}%, #ffffff ${e}%)`}));const pe=document.getElementById("player-tooltip");ae.addEventListener("mousemove",(function(e){const t=Math.round(e.offsetX/e.target.clientWidth*parseInt(e.target.getAttribute("max"),10));ae.setAttribute("data-seek",t);const n=me(t);pe.textContent=`${n.minutes}:${n.seconds}`;const o=re.getBoundingClientRect();pe.style.left=e.pageX-o.left+"px"})),ae.addEventListener("input",(function(e){const t=e.target.dataset.playerRange?e.target.dataset.playerRange:e.target.value;re.currentTime=t,ae.value=t}));const he=document.querySelector(".volume-button"),fe=document.querySelectorAll(".volume-button use"),ve=document.querySelector('use[href="#volume-mute"]'),Se=document.querySelector('use[href="#volume-low"]'),ye=document.querySelector('use[href="#volume-high"]'),Le=document.querySelector(".volume-range");Le.style.background=`linear-gradient(to right, #c1ff06, 0%,  #c1ff06, ${100*Le.value}%, #ffffff ${100*Le.value}%)`,Le.addEventListener("input",(function(){re.muted&&(re.muted=!1),re.volume=Le.value,Le.style.background=`linear-gradient(to right, #c1ff06, 0%,  #c1ff06, ${100*Le.value}%, #ffffff ${100*Le.value}%)`})),he.addEventListener("click",(function(){re.muted=!re.muted,re.muted?(Le.setAttribute("data-volume",Le.value),Le.value=0,Le.style.background="linear-gradient(to right, #c1ff06, 0%,  #c1ff06, 0%, #ffffff 0%)"):(Le.value=Le.dataset.volume,Le.style.background=`linear-gradient(to right, #c1ff06, 0%,  #c1ff06, ${100*Le.value}%, #ffffff ${100*Le.value}%)`)})),re.addEventListener("volumechange",(function(){fe.forEach((e=>{e.classList.add("hidden")})),re.muted||0===re.volume?ve.classList.remove("hidden"):re.volume>0&&re.volume<=.5?Se.classList.remove("hidden"):ye.classList.remove("hidden"),re.muted&&0===re.volume&&"0"===Le.dataset.volume&&(fe.forEach((e=>{e.classList.add("hidden")})),Se.classList.remove("hidden")),console.log(re.muted)})),re.addEventListener("ended",ge),te.addEventListener("click",(function(){ce>0?ce--:ce=z.length-1,de()})),ee.addEventListener("click",ge),K.addEventListener("click",ue);const we=document.querySelector(".todo-btn"),Ee=document.querySelector(".todo-widget-container"),Ie=document.querySelector(".todo-input"),qe=document.querySelector(".todo-add-new-btn"),be=document.querySelector(".todo-list"),ke=document.querySelector(".todo-description");we.addEventListener("click",(()=>{Ee.classList.contains("active")?Ee.classList.remove("active"):(Ee.classList.add("active"),Me())}));let Ae=localStorage.getItem("todoId")?+localStorage.getItem("todoId"):0,$e=JSON.parse(localStorage.getItem("todo"))?JSON.parse(localStorage.getItem("todo")):[],xe=JSON.parse(localStorage.getItem("todoDone"))?JSON.parse(localStorage.getItem("todoDone")):[],Te=JSON.parse(localStorage.getItem("todoNone"))?JSON.parse(localStorage.getItem("todoNone")):[],Ce=localStorage.getItem("selectTodoItem1")?localStorage.getItem("selectTodoItem1"):"all";function Me(){0===$e.length?(ke.style.display="block",qe.style.display="inline-block",Ie.style.display="none"):(ke.style.display="none",Ie.style.display="block")}qe.addEventListener("click",(e=>{Ie.style.display="block",e.target.style.display="none"}));class Ne{constructor(e,t,n){this.id=e,this.title=t,this.completed=n}}const Oe=document.querySelector("#list2");let He=[{value:"all",text:"All",length:$e.length,checked:!0},{value:"done",text:"Done",length:Te.length,checked:!1},{value:"none",text:"Not yet",length:xe.length,checked:!1}];function Je(e){be.innerHTML="",e.length>0&&e.forEach((e=>{(e=>{const t=document.createElement("li");t.classList.add("todo-items");const n=document.createElement("input");n.type="checkbox",n.id=e.id,n.classList.add("todo-check"),n.checked=e.completed,t.append(n),n.addEventListener("change",Ye);const o=document.createElement("span");o.classList.add("checkmark"),t.append(o);const a=document.createElement("div");a.id=`b${e.id}`,a.contentEditable="false",a.innerText=e.title,a.classList.add("todo-val-input"),a.addEventListener("input",We),a.addEventListener("keypress",(e=>{13===e.which&&(a.contentEditable="false")}));const l=document.createElement("label");l.classList.add("todo-label"),l.appendChild(a),t.append(l);const c=document.createElement("button");c.id=`c${e.id}`,c.classList.add("todo-button","todo-del"),t.append(c),c.addEventListener("click",Fe);const r=document.createElement("button");r.id=`d${e.id}`,r.classList.add("todo-button","todo-edit"),t.append(r),r.addEventListener("click",Ue),be.prepend(t)})(e)}))}He.forEach((e=>{!function(e){const t=document.createElement("input");t.classList.add("selectopt"),t.type="radio",t.name="todo-item",t.value=e.value,t.id=e.value,t.setAttribute("checked",e.check),Oe.append(t);const n=document.createElement("label");n.classList="select-option",n.setAttribute("for",e.value),n.id=`lab-${e.value}`,n.innerText=e.text;const o=document.createElement("span");o.classList.add("count"),o.innerText=e.length,n.appendChild(o),Oe.append(n)}(e)}));const je=document.querySelector("form");function De(){"all"==Ce?Je($e):"done"==Ce?Je(xe):"none"==Ce&&Je(Te)}function Pe(){xe=$e.filter((e=>1==e.completed))}function Re(){Te=$e.filter((e=>0==e.completed))}function Ge(){He[0].length=$e.length,document.querySelector("#lab-all span").innerText=He[0].length,He[1].length=xe.length,document.querySelector("#lab-done span").innerText=He[1].length,He[2].length=Te.length,document.querySelector("#lab-none span").innerText=He[2].length}function We(){$e.find((e=>e.id==this.id.slice(1))).title=this.innerText.trim(),Pe(),Re(),_e()}function Ue(){const e=document.querySelectorAll(".todo-val-input");let t=Array.from(e).find((e=>e.id.slice(1)==this.id.slice(1)));t.contentEditable="true",t.focus()}function Ye(){let e=$e.find((e=>e.id==this.id));e.completed=!e.completed,Pe(),Re(),Ge(),_e(),De()}function Fe(){$e=$e.filter((e=>e.id!=this.id.slice(1))),Pe(),Re(),Ge(),_e(),De(),Me()}function _e(){localStorage.setItem("todo",JSON.stringify($e)),localStorage.setItem("todoDone",JSON.stringify(xe)),localStorage.setItem("todoNone",JSON.stringify(Te))}function Be(e,t){const n=document.querySelector(".modal-panel"),o=document.querySelector(".modal"),a=document.querySelector(".modal-message");e?(n.classList.add("active"),o.classList.add("active"),a.textContent=t,document.querySelector(".modal-close").addEventListener("click",(e=>{n.classList.remove("active"),o.classList.remove("active")})),n.addEventListener("click",(e=>{e.target.classList.contains("modal")||e.target.classList.contains("modal-message")||(n.classList.remove("active"),o.classList.remove("active"))}))):(n.classList.remove("active"),o.classList.remove("active"))}je.addEventListener("submit",(e=>{e.preventDefault()})),je.elements["todo-item"].value=Ce,je.addEventListener("change",(e=>(Ce=e.target.value,"all"===e.target.value?(localStorage.setItem("selectTodoItem1","all"),Je($e)):"done"===e.target.value?(localStorage.setItem("selectTodoItem1","done"),Je(xe)):"none"===e.target.value&&(localStorage.setItem("selectTodoItem1","none"),Je(Te)),Ce))),De(),Pe(),Re(),Ge(),Ie.addEventListener("keypress",(e=>{if(13===e.which&&""!==Ie.value){Ae+=1,localStorage.setItem("todoId",Ae);let e=!1;e="done"==Ce,$e.push(new Ne(Ae,Ie.value,e)),Pe(),Re(),Ge(),_e(),De(),Me(),Ie.value=""}})),window.addEventListener("beforeunload",_e),window.addEventListener("load",(function(){localStorage.getItem("todo")&&($e=JSON.parse(localStorage.getItem("todo"))),localStorage.getItem("todoDone")&&(xe=JSON.parse(localStorage.getItem("todoDone"))),localStorage.getItem("todoNone")&&(Te=JSON.parse(localStorage.getItem("todoNone"))),localStorage.getItem("selectTodoItem1")&&(Ce=JSON.parse(localStorage.getItem("selectTodoItem1")))})),document.querySelectorAll('[name="radio-lng"]').forEach((e=>{e.addEventListener("change",(e=>{s.language=e.target.value,t(s.language),p(s.language),h(s.language),j(s.language),X(s.language),u(s.language),i(s.language),""!==I.textContent&&$(s.language)})),e.value===localStorage.getItem("language")&&(e.checked=!0)})),document.querySelectorAll('[name="widget-img"]').forEach((e=>{e.addEventListener("change",(e=>{s.photoSource=e.target.value,b(),k()})),e.value===localStorage.getItem("photoSource")&&(e.checked=!0)})),t(s.language),n(),setInterval((function(){n()}),1e3),p(s.language),window.addEventListener("beforeunload",(function(){localStorage.setItem("name",m.value)})),window.addEventListener("load",(function(){localStorage.getItem("name")&&(m.value=localStorage.getItem("name"))})),h(s.language),k(),j(s.language),document.querySelector(".change-quote").addEventListener("click",(e=>{var t;e.target.classList.toggle("active"),t=s.language,x++,x===T&&(x=0),H.then((e=>{N.classList.remove("active"),O.classList.remove("active"),setTimeout((()=>{J(t,e)}),500)}))})),X(s.language),o.addEventListener("click",(e=>{e.target.classList.toggle("active"),a.classList.contains("active")?a.classList.remove("active"):a.classList.add("active")})),u(s.language),window.addEventListener("beforeunload",(function(){localStorage.setItem("language",s.language),localStorage.setItem("photoSource",s.photoSource),localStorage.setItem("panels",JSON.stringify(s.panels))})),window.addEventListener("load",(function(){localStorage.getItem("language")&&(s.language=localStorage.getItem("language")),localStorage.getItem("photoSource")&&(s.photoSource=localStorage.getItem("photoSource")),localStorage.getItem("panels")&&(s.panels=JSON.parse(localStorage.getItem("panels")))})),i(s.language),window.addEventListener("load",(function(){this.document.body.classList.remove("preload")}))})();